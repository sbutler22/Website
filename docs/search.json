[
  {
    "objectID": "data_viz.html",
    "href": "data_viz.html",
    "title": "Data Visualizations",
    "section": "",
    "text": "← Back to home\n\nEclipses\nThis data has information about the paths of the solar eclipses on October 14, 2023 and April 8, 2024 in the United States. The eclipse datasets were accessed via the TidyTuesday project (R for Data Science community), Week of April 9, 2024. The underlying data originate from NASA’s Scientific Visualization Studio.\n\n\nCode\neclipse_annular_2023 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_annular_2023.csv')\neclipse_total_2024 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_total_2024.csv')\neclipse_partial_2023 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_partial_2023.csv')\neclipse_partial_2024 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_partial_2024.csv')\n\n\n\n\nCode\n# tidy 2024 data\ntot_24 &lt;- eclipse_total_2024 %&gt;% \n  mutate(time = eclipse_6 - eclipse_1, eclipse = \"total\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\npart_24 &lt;- eclipse_partial_2024 %&gt;% \n  mutate(time = eclipse_5 - eclipse_1, eclipse = \"partial\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\neclipse_24 &lt;- rbind(tot_24, part_24) %&gt;% \n  mutate(time = as.numeric(time))\n\n# plot 2024 data\nlibrary(ggnewscale)\nstates &lt;- map_data(\"state\")\n\ntwenty_four &lt;- ggplot(states) +\n  geom_polygon(fill = \"white\", color = \"black\",\n               aes(long,lat, group = group)) +\n  geom_point(data = filter(eclipse_24, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"total\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"blue\", \"turquoise\")) +\n  labs(color = \"time of overlap (sec)\\n total eclipse\") +\n  new_scale_color() +\n  geom_point(data = filter(eclipse_24, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"partial\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"red\", \"pink\")) +\n  ggtitle(\"2024 Solar Eclipse\") +\n  labs(x = \"\", y = \"\", color = \"time of overlap (sec)\\n partial eclipse\")\n  \n\n\n# tidy 2023 data\ntot_23 &lt;- eclipse_annular_2023 %&gt;% \n  mutate(time = eclipse_6 - eclipse_1, eclipse = \"total\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\npart_23 &lt;- eclipse_partial_2023 %&gt;% \n  mutate(time = eclipse_5 - eclipse_1, eclipse = \"partial\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\neclipse_23 &lt;- rbind(tot_23, part_23) %&gt;% \n  mutate(time = as.numeric(time))\n\n\n# plot 2023 data\nstates &lt;- map_data(\"state\")\n\ntwenty_three &lt;- ggplot(states) +\n  geom_polygon(fill = \"white\", color = \"black\",\n               aes(long,lat, group = group)) +\n  geom_point(data = filter(eclipse_23, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"total\"), \n             aes(x = lon, y= lat, color = time), size = 0.25) +\n  scale_colour_gradientn(colors = c(\"blue\", \"turquoise\")) +\n  labs(color = \"time of overlap (sec)\\n total eclipse\") +\n  new_scale_color() +\n  geom_point(data = filter(eclipse_23, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"partial\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"red\", \"pink\")) +\n  ggtitle(\"2023 Solar Eclipse\") +\n  labs(x = \"\", y = \"\", color = \"time of overlap (sec)\\n partial eclipse\")\n  \n\n# put plots together\ntwenty_three + twenty_four + plot_layout(ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\nMt. Vesuvius\nThis dataset contains information about seismic events detected at Mount Vesuvius in Italy. The data was accessed via TidyTuesday, Week of May 13, 2025, based on data from the Italian Istituto Nazionale di Geofisica e Vulcanologia (INGV). The raw data was saved as individual CSV files from the GOSSIP website and some values were translated from Italian to English.\n\n\nCode\nvesuvius &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-05-13/vesuvius.csv')\n\n\n\n\nCode\nlibrary(sf)\nlibrary(ggspatial)\n\n# drop NA lat/long since we're plotting on a map\nvesuvius &lt;- vesuvius |&gt;\n  drop_na(latitude, longitude)\n\n\n# convert data to be compatible with sf\nvesuvius_sf &lt;- st_as_sf(vesuvius, coords = c(\"longitude\", \"latitude\"), crs = 4326)\n\n\n# map for energy release\nmagnitude &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = duration_magnitude_md), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +  \n  labs(title = \"Energy Release\",\n       x = \"Longitude\", y = \"Latitude\")\n\n\n# map for year\nyear &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = year), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +  \n  labs(title = \"Year\",\n       x = \"Longitude\", y = \"Latitude\")\n\n\n# map for depth of seismic event\ndepth &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = depth_km), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +\n  labs(title = \"Depth\",\n       x = \"Longitude\", y = \"Latitude\")\n\n# put them all together\nmagnitude + year + depth + \n  plot_layout(ncol = 2) + plot_annotation(\"Earthquakes Around Mt. Vesuvius\", caption = \"Energy release measured by 'duration magnitude' (Md)\")\n\n\n\n\n\n\n\n\n\n\n\nH.E.L.P. (Health Evaluation and Linkage to Primary Care)\nThe HELP dataset comes from a longitudinal study of adults experiencing housing instability and substance use disorders in Boston in the early 2000’s, designed to evaluate factors influencing linkage to medical and social services after enrollment. It includes detailed measures of incarceration history, substance use, mental health (including CES-D depression scores), and time to successful linkage to care. The dataset can be accessed here.\n\n\nCode\nlibrary(wesanderson)\nlibrary(mosaic)\nlibrary(circlepackeR)\n\n# data\nHELPfull &lt;- read.csv(\"HELPdata_2025.csv\")\n\nHELPfull &lt;- HELPfull |&gt;\n  mutate(dayslink = as.numeric(dayslink),\n         linkstatus = as.numeric(linkstatus),\n         group = as.factor(group))\n\n\n# bin the variables to \"create\" hierarchy\n\n# each bin 19 months\nHELPfull$jail_bin &lt;- cut(HELPfull$jail_mos, breaks = 3, include.lowest = TRUE, labels = c(\"Low Jail Time\", \"Medium Jail Time\", \"Higher Jail Time\"))\n\n# each bin 14 years\nHELPfull$mj_bin  &lt;- cut(HELPfull$h10_lt, breaks = 3, include.lowest = TRUE, labels = c(\"Low Marijuna Use\", \"Medium Marijuana Use\", \"Higher Marijuana Use\"))\n\n# each bin about 20 points\nHELPfull$dep_bin  &lt;- cut(HELPfull$ces_d, breaks = 3, include.lowest = TRUE, labels = c(\"Low Depression Score\", \"Medium Depression Score\", \"Higher Depression Score\"))\n\n# create data with subgroups\ncircle_data &lt;- HELPfull |&gt;\n  group_by(jail_bin, mj_bin, dep_bin) %&gt;%\n  summarise(value = mean(dayslink, na.rm = TRUE), .groups = \"drop\")\n\nlibrary(data.tree)\n\n# circlepackeR requires hierarchy\ncircle_data$pathString &lt;- paste(\"world\", circle_data$jail_bin, circle_data$dep_bin, circle_data$mj_bin, sep = \"/\")\n\ntree_data &lt;- as.Node(circle_data)\n\n\nlibrary(htmltools)\n\n# plot\np &lt;- circlepackeR(tree_data, size = \"value\", \n             color_min = \"#91BAB6\", \n             color_max = \"#F03801\")\n\ntagList(tags$h3(style = \"color:#000000; font-family:Ipsum Larem; font-weight:400;\",\n          \"Circle Pack of Jail Time, Depression Score, and Marijuana Use\"),\n  p)\n\n\nCircle Pack of Jail Time, Depression Score, and Marijuana Use\n\n\n\n\nWhen we stratify the cohort by incarceration exposure, depressive symptom burden, and marijuana-use history, the average time to linkage differs across subgroups—suggesting these risk/complexity dimensions may be associated with slower (or faster) linkage.\n\n\nRotaries and Roundabouts\nThis dataset contains information about roundabout intersections across the world, (though we will focus on the United States). The data were accessed via TidyTuesday (Week of December 16, 2025) and are drawn from the roundabouts R package developed by Emil Hvitfeldt. The underlying database was compiled by Kittelson & Associates and includes detailed records on the location, design, configuration, and construction year of over 20,000 roundabouts globally.\n\n\nCode\nroundabouts_clean &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-12-16/roundabouts_clean.csv')\n\n\n\n\nCode\n# rotary vs roundabout\nus_states &lt;- map_data(\"state\")\n\n# create summary with ifelse condition\nroundabouts_by_state &lt;- roundabouts_clean |&gt;\n  filter(nchar(state_region) &lt;= 2) |&gt;\n  filter(!type %in% c(\"Other\", \"Signalized Roundabout/Circle\")) |&gt;\n  drop_na(type) |&gt;\n  group_by(state_region, type) |&gt;\n  summarize(count = n(), .groups = \"drop\") |&gt;\n  complete(state_region, type, fill = list(count = 0)) |&gt;\n  mutate(\n    has_50_plus = case_when(\n      count == 0 ~ \"0\",\n      count &gt;= 50 ~ \"50+\",\n      TRUE ~ \"&lt; 50\"\n    ),\n    state_name = tolower(state.name[match(state_region, state.abb)])\n  )\n\nmycolors2 &lt;- c(wes_palette(\"Darjeeling1\")[2], \"gray90\", wes_palette(\"Darjeeling1\")[4])\n\n# plot\nus_states |&gt;\n  left_join(roundabouts_by_state, by = c(\"region\" = \"state_name\")) |&gt;\n  drop_na(type) |&gt;\n  ggplot(aes(x = long, y = lat, group = group)) +\n  geom_polygon(aes(fill = has_50_plus)) +\n  scale_fill_manual(values = mycolors2) +\n  coord_map() +\n  theme_void() +\n  labs(title = \"Number of Rotaries, Roundabouts, and Traffic Circles by State\", fill = \"Count\") +\n  facet_wrap(~type) +\n  theme(plot.title = element_text(margin = margin(b = 20))) +  # b = bottom margin\n  theme(strip.text = element_text(margin = margin(b = 10)))   # space below facet titles"
  },
  {
    "objectID": "data_viz.html#the-data",
    "href": "data_viz.html#the-data",
    "title": "Data Visualizations",
    "section": "the data",
    "text": "the data\nThis data has information about the paths of the solar eclipses on October 14, 2023 and April 8, 2024 in the United States. The data comes from NASA’s Scientific Visualization Studio.\n\n\nCode\neclipse_annular_2023 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_annular_2023.csv')\neclipse_total_2024 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_total_2024.csv')\neclipse_partial_2023 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_partial_2023.csv')\neclipse_partial_2024 &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-09/eclipse_partial_2024.csv')"
  },
  {
    "objectID": "data_viz.html#maps",
    "href": "data_viz.html#maps",
    "title": "Data Visualizations",
    "section": "maps",
    "text": "maps\n\n\nCode\n# tidy 2024 data\ntot_24 &lt;- eclipse_total_2024 %&gt;% \n  mutate(time = eclipse_6 - eclipse_1, eclipse = \"total\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\npart_24 &lt;- eclipse_partial_2024 %&gt;% \n  mutate(time = eclipse_5 - eclipse_1, eclipse = \"partial\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\neclipse_24 &lt;- rbind(tot_24, part_24) %&gt;% \n  mutate(time = as.numeric(time))\n\n# plot 2024 data\nlibrary(ggnewscale)\nstates &lt;- map_data(\"state\")\n\ntwenty_four &lt;- ggplot(states) +\n  geom_polygon(fill = \"white\", color = \"black\",\n               aes(long,lat, group = group)) +\n  geom_point(data = filter(eclipse_24, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"total\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"blue\", \"turquoise\")) +\n  labs(color = \"time of overlap (sec)\\n total eclipse\") +\n  new_scale_color() +\n  geom_point(data = filter(eclipse_24, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"partial\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"red\", \"pink\")) +\n  ggtitle(\"2024 Solar Eclipse\") +\n  labs(x = \"\", y = \"\", color = \"time of overlap (sec)\\n partial eclipse\")\n  \n\n\n# tidy 2023 data\ntot_23 &lt;- eclipse_annular_2023 %&gt;% \n  mutate(time = eclipse_6 - eclipse_1, eclipse = \"total\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\npart_23 &lt;- eclipse_partial_2023 %&gt;% \n  mutate(time = eclipse_5 - eclipse_1, eclipse = \"partial\") %&gt;% \n  select(state, name, lat, lon, time, eclipse)\n\neclipse_23 &lt;- rbind(tot_23, part_23) %&gt;% \n  mutate(time = as.numeric(time))\n\n\n# plot 2023 data\nstates &lt;- map_data(\"state\")\n\ntwenty_three &lt;- ggplot(states) +\n  geom_polygon(fill = \"white\", color = \"black\",\n               aes(long,lat, group = group)) +\n  geom_point(data = filter(eclipse_23, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"total\"), \n             aes(x = lon, y= lat, color = time), size = 0.25) +\n  scale_colour_gradientn(colors = c(\"blue\", \"turquoise\")) +\n  labs(color = \"time of overlap (sec)\\n total eclipse\") +\n  new_scale_color() +\n  geom_point(data = filter(eclipse_23, lat &lt; 51 & lat &gt; 24 & lon &lt; 0 & eclipse == \"partial\"), \n             aes(x = lon, y= lat, color = time), size = 0.001) +\n  scale_colour_gradientn(colors = c(\"red\", \"pink\")) +\n  ggtitle(\"2023 Solar Eclipse\") +\n  labs(x = \"\", y = \"\", color = \"time of overlap (sec)\\n partial eclipse\")\n\n\n\n\nCode\ntwenty_three + twenty_four + plot_layout(ncol = 2)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "← Back to home\nHi!\nMy name is Sam and I’m from Philadelphia. I am currently a senior at Pomona College studying math on the statistics track. I love working with data and especially enjoy making visualizations, and this site provides a neat little place to bring them together.\nOutside of statistics, I love to spend time outdoors, rock climb, hike, and bike. I am also the captain of my collegiate track and field team, and when I’m not in Estella (our math building) I am usually down at the track. Go hens!"
  },
  {
    "objectID": "data_viz.html#earthquake-maps",
    "href": "data_viz.html#earthquake-maps",
    "title": "Data Visualizations",
    "section": "earthquake maps",
    "text": "earthquake maps\n\n\nCode\nlibrary(sf)\nlibrary(ggspatial)\n\n\n\n\nCode\nvesuvius &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-05-13/vesuvius.csv')\n\n\n\n\nCode\n# drop NA lat/long since we're plotting on a map\nvesuvius &lt;- vesuvius |&gt;\n  drop_na(latitude, longitude)\n\n\n# convert data to be compatible with sf\nvesuvius_sf &lt;- st_as_sf(vesuvius, coords = c(\"longitude\", \"latitude\"), crs = 4326)\n\n\n# map for energy release\nmagnitude &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = duration_magnitude_md), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +  \n  labs(title = \"Energy Release\",\n       x = \"Longitude\", y = \"Latitude\")\n\n\n# map for year\nyear &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = year), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +  \n  labs(title = \"Year\",\n       x = \"Longitude\", y = \"Latitude\")\n\n\n# map for depth of seismic event\ndepth &lt;- vesuvius_sf |&gt;\n  ggplot() +\n  geom_sf(aes(color = depth_km), size = 1, alpha = 0.6) +\n  scale_color_gradient(low = \"#3B4CC0\", high = \"#FADA48\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(vjust = 0.5, hjust=1, size = 5),\n        axis.title.x = element_text(vjust = -3),\n        axis.text.y = element_text(size = 5)) +\n  labs(title = \"Depth\",\n       x = \"Longitude\", y = \"Latitude\")\n\n\n\n\nCode\n# put them all together\nmagnitude + year + depth + \n  plot_layout(ncol = 2) + plot_annotation(\"Earthquakes Around Mt. Vesuvius\", caption = \"Energy release measured by 'duration magnitude' (Md)\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Sam Butler Data Projects",
    "section": "",
    "text": "Hi!\nI’m Sam Butler. I am a Math Major at Pomona college, focusing in statistics and data science. This website is home to the projects I have worked on, particularly while spending a summer leading outdoor trips for teenagers, and studying abroad in Montpellier, France, both chapters where I have been away from math and stats classes, but have still been working in R."
  },
  {
    "objectID": "research_for_website.html",
    "href": "research_for_website.html",
    "title": "Research",
    "section": "",
    "text": "← Back to home\nThis research was done in collaboration with Phineus Choi, Thomas Matheis, and Mira Terdiman under the advisement of Jo Hardin, in the summer and fall of 2025. The paper below has been submitted to the Journal of Open Source Software (JOSS).\n\nSummary\nThe R package sicegar aims to quantify time-intensity data by using sigmoidal and double-sigmoidal curves. The method was originally developed in the context of single-cell viral growth analysis (for details, see @caglar2018), and the package name stands for “SIngle CEll Growth Analysis in R”. In addition to categorizing the best model fit, sicegar returns parameter estimates for each of the model fits, providing important information to researchers.\nThe sigmoidal function is given as \\(I(x)\\), with parameters estimated using the Levenberg-Marquardt algorithm [@levenberg1944;@marquardt1963]. \\(h_0\\) represents the lower asymptote (as \\(x\\) approaches negative infinity). \\(t_1\\) is the onset time (the inflection point) and the midpoint between \\(h_0\\) and \\(h_1\\). \\(a\\) determines the magnitude of the slope of the sigmoidal curve. \\(h_1\\) is the upper asymptote (as \\(x\\) approaches positive infinity). The parameters describing the sigmoidal curve in \\(I(x)\\) are graphically represented in Figure 1.\n\\(I(x) = h_0 + \\frac{h_1-h_0}{1 + e^{-a(x - t_1)}}\\)\nA similar, but slightly more complicated, formula for the double-sigmoidal function is also used for parameter estimation in sicegar. In the original implementation of sicegar, the parameter \\(h_0\\) is set to zero for both the sigmoidal and double-sigmoidal models.\nFigure 1 Visualization of the sigmoidal curve and related parameter values.\n\n\n\nSigmoidal curve.\n\n\nsicegar’s parameter estimation allows users to extract key model parameters, including the onset time of RNA expression in specific genes [@caglar2018]. Onset time is defined as the time when the half-maximal abundance of RNA is reached in the cell. For example, @Adams uses sicegar to investigate the onset time of RNA expression from genes in E. coli undergoing stress. Accurate estimates of \\(t_1\\) are crucial for understanding transriptional timing of genes. However, @Adams observed limitations in sicegar’s fits, which motivated the package improvements proposed in our paper.\nWe have substantially modified sicegar (our work is currently implemented on CRAN) to improve the parameter estimates for both sigmoidal and double-sigmoidal models. Our primary update to the sicegar package is the inclusion and estimation of an additional parameter, \\(h_0\\), the lower asymptote of both the sigmoidal and double-sigmoidal curves, which had previously been set equal to zero. Based on simulated data, the free estimation of \\(h_0\\) provides both a better overall model fit (lower SSE) and more accurate parameter estimates than when \\(h_0\\) is forced to be equal to zero.\n\n\nStatement of Need\n@caglar2018 discuss sicegar’s ability to correctly identify sigmoidal and double-sigmoidal curves on simulated data. They report, “Overall, we can conclude that our algorithm results in reliable fits, that it fails gradually with increasing noise levels, and that it is conservative in assessing whether it has correctly identified a sigmoidal or double-sigmoidal curve or not.” The focus of their results is on whether sicegar is able to correctly identify sigmoidal and double-sigmoidal curves on simulated data, not on whether it is able to accurately report parameter estimations. Though they acknowledge sicegar’s ability to estimate parameters associated with sigmoidal and double-sigmoidal curves, they do not report on the accuracy of the parameter estimates.\nIn dozens of papers that use sicegar for modeling time-intensity data, researchers are interested in extracting specific parameter estimates, e.g., midpoints and slopes, as the parameter values represent biologically meaningful information. @Adams extracted midpoint values (\\(t_1\\)) to investigate onset time of RNA expression in genes in E. coli undergoing stress. @wittemeier used sicegar to estimate molar carbon assimilation. They used sicegar’s estimation of maximum slope in sigmoidal curves to understand maximum assimilation rate, and midpoints (\\(t_1\\)) in sigmoidal curves to extract the point at which maximum assimilation is reached. @rajarathinam also used sicegar to analyze carbon assimilation and to extract estimations of maximum slope. Our addition of \\(h_0\\) to the set of estimated parameters greatly improves the package’s ability to provide accurate parameter estimations. Through simulations, with varying levels of noise, generating parameters, and both sigmoidal and double sigmoidal curves, we were able to accurately estimate all parameter estimates, even when the lower asymptote is not zero. Though the categorization of the model as sigmoidal or double-sigmoidal is hugely important, it is not the only important aspect of the sicegar modeling. Our updated implementation, which includes the estimation of the lower asymptote, is prevailingly important, and thus our adjustments fit the needs of current research.\nAs previously mentioned, sicegar fits time-intensity data to single and double sigmoid curves, which allows users to extract key parameters including the onset time of RNA expression in specific genes [@caglar2018]. To better contextualize the relevance of sigmoid parameters to onset time, we can map the parameters described in equation \\(I(x)\\) to a plot of a typical single-sigmoid function:\n\n\nFeatures\n\nCore Functions\nfitAndCategorize, the umbrella function in sicegar, takes time-intensity data as an argument and runs through a series of nested functions. The process is outlined in Figure 1. First, the data are normalized in the function normalizeData (1). Then they are passed through multipleFitFunction (2) which uses the Levenberg-Marquardt algorithm [@levenberg1944;@marquardt1963] to fit both sigmoidal and double-sigmoidal curves to the data, (3), (4). Additional parameters are then added to the output vector in parameterCalculations to prepare the model to be plotted. The user decides whether to allow the function to estimate \\(h_0\\) using the argument use_h0 = TRUE in fitAndCategorize. If use_h0 is set to FALSE (the default), the algorithm will run sicegar as it was originally written, with \\(h_0\\) fixed at zero. If they choose to allow the function to estimate \\(h_0\\), it will follow the same function flow, except that each function will account for the estimation of \\(h_0\\).\n\n\nNovel Contributions\nEach function in sicegar was rewritten to include the parameter \\(h_0\\) in addition to a some small technical changes to the functions. Our new version is outlined in the right-hand branch of Figure 1.\nFigure 2 Structure of the fitAndCategorize function.\n\n\n\nStructure of the fitAndCategorize function.\n\n\n\n\nExample\nTo demonstrate the difference between the functionality when \\(h_0 = 0\\) versus when \\(h_0\\) is freely estimated, we present a small simulation based on sigmoidal data. The parameters in our simulation are \\(h_0=2\\), \\(h_1=4\\), \\(a=1\\), and \\(t_1=12\\). At each of nine time points on the x-axis, we have five of replicates around the sigmoidal model with normal noise (centered at 0, standard deviation of 3).\nFigure 3 Parameter estimates from simulated data.\n\nFor each of 200 simulated sigmoidal datasets, Figure 3 shows the parameter estimates for each of the four parameters given in \\(I(x)\\), see Figure 1. The red vertical line indicates the value of the parameter used for data generation. It should be noted that allowing \\(h_0\\) to be freely estimated provides both more accurate parameter estimations — notably for \\(t_1\\) — and better categorizations of the model (as “sigmoidal” rather than “ambiguous”). Similar results occur when the package is run on simulated data with more noise, as well as on data simulated from the double-sigmoidal model. Our simulation does not prove that estimating \\(h_0\\) freely is always preferable, but it does indicate that there are circumstances in which estimating \\(h_0\\) is important for full approximation of the model.\n\n\n\nAvailability\nThe sicegar package is available on CRAN (https://CRAN.R-project.org/package=sicegar) and GitHub (https://github.com/hardin47/sicegar). Documentation, including vignettes and examples, is provided to facilitate adoption.\n\n\nAcknowledgements\nThe authors gratefully acknowledge Dan Stoebel for bringing the application to our attention and Federica Domecq Lacroze for sharing her explorations of the sicegar package.\n\n\nReferences"
  },
  {
    "objectID": "154_class_proj.html",
    "href": "154_class_proj.html",
    "title": "Class Projects",
    "section": "",
    "text": "← Back to home\nThis project was for a class in computational statistics at Pomona. I worked on it with Federica Domecq Lacroze. The project dives into different aspects of the higher education world in the United States, and was a blast to make!\nAccess it here:\nUniversities Shiny App"
  },
  {
    "objectID": "hex_sticker.html",
    "href": "hex_sticker.html",
    "title": "hex_sticker",
    "section": "",
    "text": "library(hexSticker)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.3.3\n\n\nWarning: package 'tibble' was built under R version 4.3.3\n\n\nWarning: package 'purrr' was built under R version 4.3.3\n\n\nWarning: package 'lubridate' was built under R version 4.3.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(sicegar)\n\n\n# wes colors\n\"#FF0000\"\n\n[1] \"#FF0000\"\n\n\"#00A08A\"\n\n[1] \"#00A08A\"\n\n\"#F2AD00\"\n\n[1] \"#F2AD00\"\n\n\"#F98400\"\n\n[1] \"#F98400\"\n\n\"#5BBCD6\"\n\n[1] \"#5BBCD6\"\n\n\n\nsicegar\n\n# --- Simulate sigmoidal data ---\nuse_h0 &lt;- FALSE\nnoise_parameter &lt;- 0.3\nreps &lt;- 5\ntime &lt;- seq(0, 24, 3)\n\nmean_vals &lt;- rep(\n  sigmoidalFitFormula_h0(time,\n                         maximum = 4,\n                         slopeParam = 1,\n                         midPoint = 12,\n                         h0 = 3),\n  reps\n)\n\nintensity &lt;- rnorm(\n  n = length(mean_vals),\n  mean = mean_vals,\n  sd = rep(noise_parameter, length(mean_vals))\n)\n\ndataInput &lt;- data.frame(intensity = intensity, time = rep(time, reps))\n\n# --- Fit the sigmoid curve ---\nsig_fit &lt;- fitAndCategorize(dataInput, use_h0 = TRUE,)\n\n# --- Generate fitted curve for plotting ---\nfit_data &lt;- data.frame(\n  time,\n  fitted = sigmoidalFitFormula_h0(\n    time,\n    maximum = sig_fit$sigmoidalModel$maximum_Estimate,\n    slopeParam = sig_fit$sigmoidalModel$slopeParam_Estimate,\n    midPoint = sig_fit$sigmoidalModel$midPoint_Estimate,\n    h0 = sig_fit$sigmoidalModel$h0_Estimate\n  )\n)\n\n# --- Make the ggplot (subplot for sticker) ---\nsig_plot &lt;- ggplot(dataInput, aes(x = time, y = intensity)) +\n  geom_point(color = \"white\", size = 1.2, alpha = 0.7) +\n  geom_line(data = fit_data, aes(y = fitted), color = \"#E27D60\", size = 1) +\n  theme_void() +\n  theme_transparent()  # remove background, clean look for sticker\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n# --- Create sticker ---\ns &lt;- sticker(\n  sig_plot,\n  package = \"sicegar\",\n  p_size = 20,\n  s_x = 1,\n  s_y = 0.75,\n  s_width = 1.3,\n  s_height = 0.9,\n  filename = \"sigmoidal_curve_sticker.png\"\n)\n\nplot(s)\n\n\n\n\n\n\n\n\n\nuse_h0 &lt;- TRUE\nnoise_parameter &lt;- 0.25\nreps &lt;- 5\ntime &lt;- seq(0, 24, 3)\n\nmean_vals &lt;- rep(\n  sigmoidalFitFormula_h0(time,\n                         maximum = 4,\n                         slopeParam = 1,\n                         midPoint = 12,\n                         h0 = 3),\n  reps\n)\n\nintensity &lt;- rnorm(\n  n = length(mean_vals),\n  mean = mean_vals,\n  sd = rep(noise_parameter, length(mean_vals))\n)\n\ndataInput &lt;- data.frame(intensity = intensity, time = rep(time, reps))\n\ndataInput |&gt;\n  ggplot(aes(x = time, y = intensity)) +\n  geom_point()\n\n\n\n\n\n\n\n\n\n\nMe\n\nlibrary(hexSticker)\nlibrary(magick)\n\nWarning: package 'magick' was built under R version 4.3.3\n\n\nLinking to ImageMagick 6.9.12.93\nEnabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n\nimg &lt;- image_read(\"Images/head_shot_hex.jpeg\") |&gt;\n  image_resize(\"2000x2000^\") |&gt;\n  image_crop(\"2000x2000\")\n\nhex_mask &lt;- image_blank(2000, 2000, color = \"transparent\") |&gt;\n  image_draw()\npolygon(\n  x = c(1000, 1850, 1850, 1000, 150, 150),\n  y = c(0, 500, 1500, 2000, 1500, 500),\n  col = \"white\", border = NA\n)\ndev.off()\n\nquartz_off_screen \n                2 \n\nhex_img &lt;- image_composite(img, hex_mask, operator = \"copyopacity\")\n\n# IMPORTANT: force PNG output\nimage_write(hex_img, path = \"headshot_hex_masked.png\", format = \"png\")\n\n\n# make sticker\nme &lt;- sticker(\n  subplot  = \"headshot_hex_masked.png\",\n  package  = \"\",\n  s_x      = 1, s_y = 1,\n  s_width  = 1, s_height = 1,\n  h_color = \"#F2AD00\",\n  filename = \"hex-face.png\",\n  dpi      = 800\n)\n\nplot(me)\n\n\n\n\n\n\n\n\n\n\nresearch\n\nlibrary(sicegar)\nlibrary(tidyverse)\n# --- Simulate sigmoidal data ---\nuse_h0 &lt;- FALSE\nnoise_parameter &lt;- 0.2\nreps &lt;- 5\ntime &lt;- seq(0, 24, 3)\n\nmean_vals &lt;- rep(\n  sigmoidalFitFormula_h0(time,\n                         maximum = 4,\n                         slopeParam = 1,\n                         midPoint = 12,\n                         h0 = 3),\n  reps\n)\n\nintensity &lt;- rnorm(\n  n = length(mean_vals),\n  mean = mean_vals,\n  sd = rep(noise_parameter, length(mean_vals))\n)\n\ndataInput &lt;- data.frame(intensity = intensity, time = rep(time, reps))\n\n# --- Fit the sigmoid curve ---\nsig_fit &lt;- fitAndCategorize(dataInput, use_h0 = TRUE,)\n\n# --- Generate fitted curve for plotting ---\nfit_data &lt;- data.frame(\n  time,\n  fitted = sigmoidalFitFormula_h0(\n    time,\n    maximum = sig_fit$sigmoidalModel$maximum_Estimate,\n    slopeParam = sig_fit$sigmoidalModel$slopeParam_Estimate,\n    midPoint = sig_fit$sigmoidalModel$midPoint_Estimate,\n    h0 = sig_fit$sigmoidalModel$h0_Estimate\n  )\n)\n\n# --- Make the ggplot (subplot for sticker) ---\nsig_plot &lt;- ggplot(dataInput, aes(x = time, y = intensity)) +\n  geom_point(color = \"white\", size = 1.2, alpha = 0.7) +\n  geom_line(data = fit_data, aes(y = fitted), color = \"#F98400\", size = 1) +\n  theme_void() +\n  theme_transparent()  # remove background, clean look for sticker\n\n# --- Create sticker ---\ns &lt;- sticker(\n  sig_plot,\n  package = \"Research\",\n  p_size = 20,\n  s_x = 1,\n  s_y = 0.75,\n  s_width = 1.3,\n  s_height = 0.9,,\n  h_fill   = \"#5BBCD6\",   # background color\n  h_color  = \"#00A08A\",   # outline color\n  filename = \"hex-research.png\"\n)\n\nplot(s)\n\n\n\n\n\n\n\n\n\n\nabout\n\nabout &lt;- sticker(\n  subplot  = \"Images/liberty_bell.png\",\n  package  = \"About me\",\n  p_size   = 36,\n  s_x      = 1,\n  s_y      = 0.75,\n  s_width  = 0.45,\n  h_fill   = \"#00A08A\",   # background color\n  h_color  = \"#FF0000\",   # outline color\n  filename = \"hex-about.png\",\n  dpi      = 600\n)\n\nplot(about)\n\n\n\n\n\n\n\n\n\n\ndata viz\n\ndata_viz &lt;- sticker(\n  subplot  = \"Images/us_map.png\",\n  package  = \"Data Viz\",\n  p_size   = 36,\n  s_x      = 1,\n  s_y      = 0.75,\n  s_width  = 0.55,\n  h_fill   = \"#F2AD00\",   # background color\n  h_color  = \"#FF0000\",   # outline color\n  filename = \"hex-data_viz.png\",\n  dpi      = 600\n)\n\nplot(data_viz)\n\n\n\n\n\n\n\n\n\n\ncolleges\n\ncollege &lt;- sticker(\n  subplot  = \"Images/class.png\",\n  package  = \"Comp Stats Project\",\n  p_size   = 28,\n  s_x      = 1,\n  s_y      = 0.75,\n  s_width  = 0.35,\n  h_fill   = \"#FF0000\",   # background color\n  h_color  = \"#5BBCD6\",   # outline color\n  filename = \"hex-class_project.png\",\n  dpi      = 600\n)\n\nplot(college)\n\n\n\n\n\n\n\n\n```"
  }
]